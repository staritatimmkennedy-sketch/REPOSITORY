<!-- pages/materialType.html -->

<div id="material-types" class="p-6">
  <!-- Header Card -->
  <div class="bg-white border rounded-lg p-4 mb-6 shadow-sm">
    <div class="flex flex-col sm:flex-row sm:items-center gap-3">
      <input type="text" id="searchType" placeholder="Search by ID, name, or description"
             class="flex-grow px-4 py-2 border rounded-md text-sm focus:ring focus:ring-green-500 focus:outline-none">
      <button id="openAddMaterialType"
              type="button"
              class="flex items-center px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 whitespace-nowrap">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
        </svg>
        Add Material Type
      </button>
    </div>
  </div>

  <!-- Table -->
  <div class="bg-white rounded-lg shadow overflow-visible">
    <table class="w-full border-collapse" id="materialTypesTable">
      <thead>
        <tr class="bg-gray-100 border-b">
          <th class="text-left px-4 py-3 text-sm font-semibold text-gray-700 w-1/12">ID</th>
          <th class="text-left px-4 py-3 text-sm font-semibold text-gray-700 w-3/12">Type Name</th>
          <th class="text-left px-4 py-3 text-sm font-semibold text-gray-700 w-7/12">Description</th>
          <th class="text-center px-4 py-3 text-sm font-semibold text-gray-700 w-1/12">Actions</th>
        </tr>
      </thead>
      <tbody>
        <?php if (!empty($materialTypes)): ?>
          <?php foreach ($materialTypes as $mt): ?>
            <tr class="border-b hover:bg-gray-50"
                data-id="<?= htmlspecialchars($mt['id'] ?? '', ENT_QUOTES, 'UTF-8') ?>"
                data-name="<?= htmlspecialchars(strtolower($mt['name'] ?? ''), ENT_QUOTES, 'UTF-8') ?>"
                data-desc="<?= htmlspecialchars(strtolower($mt['desc'] ?? ''), ENT_QUOTES, 'UTF-8') ?>">
              <td class="px-4 py-3 text-sm"><?= htmlspecialchars($mt["id"] ?? '—', ENT_QUOTES, 'UTF-8') ?></td>
              <td class="px-4 py-3 text-sm"><?= htmlspecialchars($mt["name"] ?? '—', ENT_QUOTES, 'UTF-8') ?></td>
              <td class="px-4 py-3 text-sm"><?= htmlspecialchars($mt["desc"] ?? '—', ENT_QUOTES, 'UTF-8') ?></td>
              <td class="px-4 py-3 text-center">
                <div class="relative inline-block text-left">
                  <button type="button" class="dropdown-toggle w-24 text-center px-3 py-1 bg-gray-200 border border-gray-400 text-sm rounded-md hover:bg-gray-300 focus:outline-none whitespace-nowrap">
                    Manage ▾
                  </button>
                  <div class="dropdown-menu hidden absolute right-0 mt-1 w-40 bg-white border rounded-md shadow-md z-10">
                    <a href="#" class="edit-type-btn block px-4 py-2 text-sm hover:bg-gray-100">Edit Type</a>
                    <a href="#" class="view-type-btn block px-4 py-2 text-sm hover:bg-gray-100">View Type</a>
                    <a href="#" class="delete-type-btn block px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Remove Type</a>
                  </div>
                </div>
              </td>
            </tr>
          <?php endforeach; ?>
        <?php else: ?>
          <tr id="noDataRow"><td colspan="4" class="px-4 py-3 text-center text-gray-500">No material types found.</td></tr>
        <?php endif; ?>
      </tbody>
    </table>
  </div>
</div>

<!-- Add Material Type Modal -->
<div id="addMaterialTypeModal" 
     class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden transition-opacity duration-300">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
    <h2 class="text-lg font-bold mb-4">Add Material Type</h2>

    <form id="addMaterialTypeForm">
      <div class="mb-3">
        <label class="block text-sm font-medium text-gray-700 mb-1">Type Name <span class="text-red-500">*</span></label>
        <input type="text" name="materialTypeName" required 
               class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring focus:ring-green-500 focus:border-green-500 focus:outline-none" 
               placeholder="Enter material type name" />
      </div>

      <div class="mb-3">
        <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
        <textarea name="materialTypeDescription" rows="3"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 focus:ring focus:ring-green-500 focus:border-green-500 focus:outline-none"
                  placeholder="Enter description (optional)"></textarea>
      </div>

      <div class="flex justify-end space-x-2 mt-4">
        <button type="button" id="closeAddMaterialType"
                class="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">Cancel</button>
        <button type="submit"
                class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">Save</button>
      </div>
    </form>
  </div>
</div>

<!-- Include modals -->
<?php include 'update_material_type_modal.php'; ?>
<?php include 'delete_material_type_modal.php'; ?>

<script src="pages/materialType.js"></script>