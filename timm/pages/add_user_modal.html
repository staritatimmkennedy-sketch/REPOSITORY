<!-- Add User Modal -->
<div id="addUserModal" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-lg">
    <h2 class="text-lg font-bold mb-4">Add New User</h2>

    <?php
    require_once __DIR__ . '/../db.php';

    if (!isset($conn) || !($conn instanceof PDO)) {
        echo '<p class="text-red-500">Error: DB not available</p>';
        $roles = [];
        $courses = [];
    } else {
        $roleQuery = $conn->query("SELECT role_id, roleName FROM role ORDER BY roleName");
        $roles = $roleQuery->fetchAll(PDO::FETCH_ASSOC);

        $courseQuery = $conn->query("SELECT course_id, courseName FROM course ORDER BY courseName");
        $courses = $courseQuery->fetchAll(PDO::FETCH_ASSOC);
    }
    ?>

    <form id="addUserForm" method="POST">
      <!-- Username -->
      <div class="mb-3">
        <label>Username <span class="text-red-500">*</span></label>
        <input type="text" name="username" required class="w-full border rounded px-3 py-2" />
      </div>

      <!-- First Name -->
      <div class="mb-3">
        <label>First Name <span class="text-red-500">*</span></label>
        <input type="text" name="first_name" required class="w-full border rounded px-3 py-2" />
      </div>

      <!-- Last Name -->
      <div class="mb-3">
        <label>Last Name <span class="text-red-500">*</span></label>
        <input type="text" name="last_name" required class="w-full border rounded px-3 py-2" />
      </div>

      <!-- Middle Name -->
      <div class="mb-3">
        <label>Middle Name</label>
        <input type="text" name="middle_name" class="w-full border rounded px-3 py-2" />
      </div>

      <!-- Role -->
      <div class="mb-3">
        <label>Role <span class="text-red-500">*</span></label>
        <select name="role" required class="w-full border rounded px-3 py-2">
          <option value="">Select Role</option>
          <?php foreach ($roles as $role): ?>
            <option value="<?= htmlspecialchars($role['role_id']) ?>">
              <?= htmlspecialchars($role['roleName']) ?>
            </option>
          <?php endforeach; ?>
        </select>
      </div>

      <!-- Course -->
      <div class="mb-3">
        <label>Course <span class="text-red-500">*</span></label>
        <select name="course" required class="w-full border rounded px-3 py-2">
          <option value="">Select Course</option>
          <?php foreach ($courses as $course): ?>
            <option value="<?= htmlspecialchars($course['course_id']) ?>">
              <?= htmlspecialchars($course['courseName']) ?>
            </option>
          <?php endforeach; ?>
        </select>
      </div>

      <!-- Year Level -->
      <div class="mb-3">
        <label>Year Level <span class="text-red-500">*</span></label>
        <select name="year_level" required class="w-full border rounded px-3 py-2">
          <option value="">Select Year Level</option>
          <option value="1">1st Year</option>
          <option value="2">2nd Year</option>
          <option value="3">3rd Year</option>
          <option value="4">4th Year</option>
        </select>
      </div>

      <div class="form-actions flex justify-end space-x-2">
        <button type="button" id="cancelAddUser" class="cf-button bg-gray-300 text-gray-700">Cancel</button>
        <button type="submit" class="cf-button bg-blue-600 text-white">Add User</button>
      </div>
    </form>
  </div>
</div>