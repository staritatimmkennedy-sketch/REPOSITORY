<div id="myBorrowings" class="p-6">
    <!-- Header with Search & Filters -->
    <div class="bg-white border rounded-lg p-4 mb-6 shadow-sm">
      <div class="flex flex-col sm:flex-row sm:items-center gap-3">
        <!-- Search Bar -->
        <input type="text" id="searchBorrowing" placeholder="Search by title or author..."
               class="flex-grow px-4 py-2 border rounded-md text-sm focus:ring focus:ring-green-500 focus:outline-none">
  
        <!-- Status Filter -->
        <select id="statusFilter" class="px-3 py-2 border rounded-md text-sm focus:ring focus:ring-green-500 focus:outline-none">
          <option value="">All Status</option>
          <option value="REQUESTED">Requested</option>
          <option value="APPROVED">Approved</option>
          <option value="BORROWED">Borrowed</option>
          <option value="RETURNED">Returned</option>
          <option value="DENIED">Denied</option>
        </select>
      </div>
    </div>
  
    <!-- Borrowing Table -->
    <div class="bg-white rounded-lg shadow overflow-hidden">
      <table class="w-full border-collapse text-left" id="borrowingTable">
        <thead class="bg-gray-100 border-b">
          <tr>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Date Requested</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Title</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Material Type</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Author</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Call No.</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Due Date</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600">Status</th>
            <th class="px-4 py-3 text-sm font-semibold text-gray-600 text-center">Action</th>
          </tr>
        </thead>
        <tbody id="borrowingRequestsBody">
          <tr>
            <td colspan="8" class="px-4 py-3 text-center text-sm text-gray-500">Loading your requests...</td>
          </tr>
        </tbody>
      </table>
    </div>
</div>

<!-- Details Modal -->
<div id="detailsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex items-center justify-between p-6 border-b">
        <h3 class="text-lg font-semibold text-gray-900">Request Details</h3>
        <button type="button" class="text-gray-400 hover:text-gray-600 close-details-modal" aria-label="Close modal">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
  
      <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Material Information -->
          <div class="space-y-4">
            <h4 class="font-medium text-gray-900 border-b pb-2">Material</h4>
            <div class="space-y-2 text-sm">
              <div><span class="font-medium">Title:</span> <span id="detailMaterialTitle" class="text-gray-700"></span></div>
              <div><span class="font-medium">Call Number:</span> <span id="detailCallNumber" class="text-gray-700"></span></div>
              <div><span class="font-medium">Type:</span> <span id="detailMaterialType" class="text-gray-700"></span></div>
              <div><span class="font-medium">Author:</span> <span id="detailAuthor" class="text-gray-700"></span></div>
              <div><span class="font-medium">Current Status:</span> <span id="detailMaterialStatus" class="text-gray-700"></span></div>
            </div>
          </div>
  
          <!-- Request Details -->
          <div class="space-y-4">
            <h4 class="font-medium text-gray-900 border-b pb-2">Request</h4>
            <div class="space-y-2 text-sm">
              <div><span class="font-medium">Status:</span> <span id="detailBorrowStatus" class="text-gray-700"></span></div>
              <div><span class="font-medium">Request Date:</span> <span id="detailBorrowedDate" class="text-gray-700"></span></div>
              <div><span class="font-medium">Approval Date:</span> <span id="detailApprovalDate" class="text-gray-700"></span></div>
              <div><span class="font-medium">Due Date:</span> <span id="detailDueDate" class="text-gray-700"></span></div>
            </div>
          </div>
  
          <!-- Remarks -->
          <div class="space-y-4 md:col-span-2">
            <h4 class="font-medium text-gray-900 border-b pb-2">Remarks</h4>
            <div class="space-y-2 text-sm">
              <div><span class="font-medium">Your Remarks:</span></div>
              <div id="detailStudentRemarks" class="text-gray-700 bg-gray-50 p-3 rounded-md min-h-[60px]"></div>
              <div><span class="font-medium">Librarian Remarks:</span></div>
              <div id="detailLibrarianRemarks" class="text-gray-700 bg-gray-50 p-3 rounded-md min-h-[60px]"></div>
            </div>
          </div>
        </div>
      </div>
  
      <div class="flex justify-end space-x-3 p-6 border-t bg-gray-50 rounded-b-lg">
        <button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 close-details-modal">
          Close
        </button>
      </div>
    </div>
</div>

<!-- View Material Modal (PDF) -->
<div id="viewModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-5xl h-[85vh] flex flex-col">
        <!-- Header -->
        <div class="flex justify-between items-center p-4 border-b">
            <h2 class="text-xl font-bold text-gray-800">View Borrowed Material (PDF)</h2>
            <button class="close-view-modal text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
        </div>

        <!-- PDF Viewer + Loading -->
        <div class="flex-1 relative overflow-hidden bg-gray-50">
            <iframe id="pdfViewer" class="absolute inset-0 w-full h-full border-0"></iframe>

            <!-- Loading -->
            <div id="pdfLoading" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-80">
                <div class="animate-spin rounded-full h-12 w-12 border-b-4 border-blue-600"></div>
                <p class="mt-3 text-gray-700 font-medium">Loading PDF...</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="p-4 border-t text-right">
            <button class="close-view-modal px-5 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Close</button>
        </div>
    </div>
</div>

<!-- Return Modal -->
<div id="returnModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md mx-4">
        <div class="flex items-center justify-between p-6 border-b">
            <h3 class="text-lg font-semibold text-gray-900">Return Material</h3>
            <button type="button" class="text-gray-400 hover:text-gray-600 close-return-modal" aria-label="Close modal">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        <div class="p-6">
            <p id="returnModalMessage" class="text-sm text-gray-700">Are you sure you want to return this material?</p>
        </div>
        <div class="flex justify-end space-x-3 p-6 border-t bg-gray-50 rounded-b-lg">
            <button type="button" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 close-return-modal">
                Cancel
            </button>
            <button type="button" class="px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" id="confirmReturnBtn">
                Return
            </button>
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="pages/userBorrowedMaterials.js"></script>